<!DOCTYPE html>
<!--[if lt IE 7]><html class="lt-ie9 lt-ie8 lt-ie7" lang="en" dir="ltr"><![endif]-->
<!--[if IE 7]><html class="lt-ie9 lt-ie8" lang="en" dir="ltr"><![endif]-->
<!--[if IE 8]><html class="lt-ie9" lang="en" dir="ltr"><![endif]-->
<!--[if gt IE 8]><!--><html lang="en" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ og: http://ogp.me/ns# rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema#"><!--<![endif]-->
<head>
<meta charset="utf-8" />
<link rel="shortlink" href="/node/8" />
<link rel="shortcut icon" href="/sites/all/themes/humblebeggining/favicon.ico" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
<link rel="canonical" href="/zend-framework-stand-alone-upload-form" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<title>Zend Framework Stand Alone Upload Form | strayed-bits.net</title>
<link rel="stylesheet" href="/sites/default/files/css/css_xE-rWrJf-fncB6ztZfd2huxqgxu4WO-qwma6Xer30m4.css" media="all" />
<link rel="stylesheet" href="/sites/default/files/css/css_uGbAYUquy_hLL8-4YI1pUCShW2j1u-tewieW2F4S-ks.css" media="all" />
<link rel="stylesheet" href="/sites/default/files/css/css_y7x-E9HU1xpIegvHoNXPU22DGIObba-YNi7929-l8do.css" media="all" />
<link rel="stylesheet" href="/sites/default/files/css/css_WkIQlS2V8h4Vh16HARhGTGX8u2nA_FzvuTZ5-DXLwaQ.css" media="screen" />
<link rel="stylesheet" href="/sites/default/files/css/css_8Na81x0TlPmv0mkfYwNa_rXnluHjk6jVfeDy47i0A6g.css" media="all" />
<link rel="stylesheet" href="/sites/default/files/css/css_5TxylIDFcnpmO5ucPRfXTdJiyW00MUBYhBuo7SANpds.css" media="print" />
<link rel="stylesheet" href="/sites/default/files/css/css_szF50th7JCQ5i-POEGKXQP_VswalbWOHBoB9pdfA5j0.css" media="only screen" />
<link rel="stylesheet" href="/sites/default/files/css/css_RqJOM7P-Bm3_FSClEoZknlX2hqHqo9WVAtkBV6DUX4U.css" media="screen" />
<link rel="stylesheet" href="/sites/default/files/css/css_gccWjowuH2fga-UCn3xqMw9Uiy1zP2lhOgGv8CdwGnY.css" media="only screen" />

<!--[if lt IE 9]>
<link rel="stylesheet" href="/sites/default/files/css/css_-ZfMH-iGLlNE6FZNiIjxRGAkOtmJJKiJ_uqtiYeduqw.css" media="screen" />
<![endif]-->
<script src="/sites/default/files/js/js_xAPl0qIk9eowy_iS9tNkCWXLUVoat94SQT48UBCFkyQ.js"></script>
<script src="/sites/default/files/js/js_fgYrkXtuxzG9Elq7qwZaJnWe7qsPHbpE3Jg3qw1CVcc.js"></script>
<script>jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"humblebeginning","theme_token":"tItKyBUaKvXO0QwAaPjehGbgRdh6uxjp405DzHErDPs","js":{"sites\/all\/modules\/syntaxhighlighter\/syntaxhighlighter.min.js":1,"misc\/jquery.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shCore.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushCss.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushJScript.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushPhp.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushSql.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushXml.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/comment\/comment.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/ctools\/css\/ctools.css":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/styles\/shCore.css":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/styles\/shThemeDefault.css":1,"sites\/all\/themes\/adaptivetheme\/at_core\/css\/at.settings.style.headings.css":1,"sites\/all\/themes\/adaptivetheme\/at_core\/css\/at.settings.style.image.css":1,"sites\/all\/themes\/adaptivetheme\/at_core\/css\/at.layout.css":1,"sites\/all\/themes\/corolla\/css\/html-elements.css":1,"sites\/all\/themes\/corolla\/css\/forms.css":1,"sites\/all\/themes\/corolla\/css\/tables.css":1,"sites\/all\/themes\/corolla\/css\/page.css":1,"sites\/all\/themes\/corolla\/css\/articles.css":1,"sites\/all\/themes\/corolla\/css\/comments.css":1,"sites\/all\/themes\/corolla\/css\/fields.css":1,"sites\/all\/themes\/corolla\/css\/blocks.css":1,"sites\/all\/themes\/corolla\/css\/navigation.css":1,"sites\/all\/themes\/corolla\/css\/fonts.css":1,"sites\/all\/themes\/corolla\/css\/corolla.settings.style.css":1,"sites\/all\/themes\/corolla\/color\/colors.css":1,"sites\/all\/themes\/humblebeggining\/css\/humblebeginning.css":1,"sites\/all\/themes\/corolla\/css\/print.css":1,"public:\/\/adaptivetheme\/humblebeginning_files\/humblebeginning.responsive.layout.css":1,"public:\/\/adaptivetheme\/humblebeginning_files\/humblebeginning.fonts.css":1,"public:\/\/adaptivetheme\/humblebeginning_files\/humblebeginning.responsive.styles.css":1,"public:\/\/adaptivetheme\/humblebeginning_files\/humblebeginning.lt-ie9.layout.css":1}},"adaptivetheme":{"humblebeginning":{"layout_settings":{"bigscreen":"three-col-grail","tablet_landscape":"three-col-grail","tablet_portrait":"one-col-vert"},"media_query_settings":{"bigscreen":"only screen and (min-width:1025px)","tablet_landscape":"only screen and (min-width:769px) and (max-width:1024px)","tablet_portrait":"only screen and (min-width:481px) and (max-width:768px)"}}}});</script>
<!--[if lt IE 9]>
<script src="/sites/all/themes/adaptivetheme/at_core/scripts/html5.js?"></script>
<![endif]-->
</head>
<body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-8 node-type-article atv-0.1 site-name-strayed-bitsnet section-zend-framework-stand-alone-upload-form color-scheme-default humblebeginning bs-n bb-n mb-dd rc-6 rct-6">
  <div id="skip-link" class="nocontent">
    <a href="#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
    <div id="page-wrapper">
  <div id="page" class="page snc-n snw-n sna-l sns-n ssc-n ssw-n ssa-l sss-n btc-n btw-b bta-l bts-n ntc-n ntw-b nta-l nts-n ctc-n ctw-b cta-l cts-n ptc-n ptw-b pta-l pts-n">

          <div id="menu-bar-wrapper">
        <div class="container clearfix">
          <div id="menu-bar" class="nav clearfix"><nav id="block-system-main-menu" class="block block-system block-menu menu-wrapper menu-bar-wrapper clearfix odd first last block-count-1 block-region-menu-bar block-main-menu"  role="navigation">  
      <h2 class="element-invisible block-title">Main menu</h2>
  
  <ul class="menu clearfix"><li class="first leaf menu-depth-1 menu-item-391"><a href="/about">About</a></li><li class="last leaf menu-depth-1 menu-item-218"><a href="/">Home</a></li></ul>
  </nav></div>        </div>
      </div>
    
    <div id="header-wrapper">
      <div class="container clearfix">

        <header class="clearfix with-logo" role="banner">

                      <div id="branding" class="branding-elements clearfix">

                              <div id="logo">
                  <a href="/"><img class="site-logo" typeof="foaf:Image" src="/sites/all/themes/humblebeggining/logo.png" alt="strayed-bits.net" /></a>                </div>
              
                              <div class="h-group" id="name-and-slogan">

                                      <h1 id="site-name"><a href="/" title="Home page">strayed-bits.net</a></h1>
                  
                  
                </div>
              
            </div>
          
          
        </header>

      </div>
    </div>

    
    
    
    <div id="content-wrapper">
      <div class="container">

        <div id="columns">
          <div class="columns-inner clearfix">

            <div id="content-column">
              <div class="content-inner">

                
                <section id="main-content" role="main">

                  
                  <div class="content-margin">
                    <div class="content-style">

                      
                      
                      
                                              <header class="clearfix">
                          <h1 id="page-title">
                            Zend Framework Stand Alone Upload Form                          </h1>
                        </header>
                      
                      
                      
                      <div id="content">
                        <div class="region region-content"><div id="block-system-main" class="block block-system no-title odd first last block-count-2 block-region-content block-main" >  
  
  <article id="node-8" class="node node-article node-promoted article odd node-full ia-n clearfix" role="article">
  <div class="node-inner">

    
              <header class="node-header">

                  <h1 class="node-title">
                          Zend Framework Stand Alone Upload Form                      </h1>
        
                  <p class="submitted">Submitted by <span class="username">Rayhan Muktader</span> on <time datetime="2012-08-13T11:32:46-0400" pubdate="pubdate">Mon, 08/13/2012 - 11:32</time></p>
        
      </header>
        
    <div class="node-content">
        <div class="field field-name-body field-type-text-with-summary field-label-hidden view-mode-full"><div class="field-items" id="md1"><div class="field-item even"><p>
In this post I'll document how to build a stand alone zend framework upload form.
</p>
<p>
I am using the slightly modified version the form code I had used for my previous posts.  This time I added a Zend_Form_element_File and used the receive() function on it to save the file.
</p>
<p><a href="https://github.com/rmuktader/zf-stand-alone-upload-form">Download link</a></p>
<pre class="brush:php;">
&lt;?php
error_reporting(E_ALL);
ini_set('display_errors', '1');
/**
 * @file form.php
 */
 
// Load Zend Framework
set_include_path(
        implode(PATH_SEPARATOR, array(
                get_include_path(),
                __DIR__ .'/'
        ))
);
        
// Create the auto loader so zend can load the rest automatically
require_once 'Zend/Loader/Autoloader.php';
$autoloader = Zend_Loader_Autoloader::getInstance();

$form = new Zend_Form;

// Set form name, id, method and action
$form-&gt;setName( 'fileUpload' )
    -&gt;setAttrib( 'id', 'fileUpload' )
    -&gt;setMethod( 'post' )
    -&gt;setAttrib('enctype', 'multipart/form-data')
    -&gt;setAction( 'http://'.
        $_SERVER['SERVER_NAME'] . $_SERVER['REQUEST_URI'] 
    );
    
$file = new Zend_Form_Element_File( 'file' );
        $file-&gt;setLabel( 'File' )
            -&gt;setRequired(true)
            //do not save file when getValues() is called
            -&gt;setValueDisabled(False)
            -&gt;addValidator( 'Extension', FALSE, 'jpg,jpeg' )
            -&gt;addValidator(
                'Size', 
                false, 
                array( 'min' =&gt; 20, 'max' =&gt; 20000000 ) // 2MB
            );
             
$file-&gt;getValidator('Extension')-&gt;setMessage( 'JPEGs only' );             
            
// Create text area for message    
$message = new Zend_Form_Element_Textarea( 'message' );
$message-&gt;setRequired( TRUE )
    -&gt;setAttrib( 'id', 'message' )
    -&gt;addErrorMessage( 'Please specify a message' );

// Create a submit button    
$submit = new Zend_Form_Element_Submit( 'submit' );
$submit-&gt;setLabel( 'Submit' )
    -&gt;setAttrib( 'id', 'submit' );

// Set the ViewScript decorator for the form and tell it which 
// template file to use
$form-&gt;setDecorators( array( 
    array( 'ViewScript', array( 'viewScript' =&gt; 'form-contact.tpl.php' ) ) ) );

// Add the form elements AFTER the viewscript decorator has been set
$form-&gt;addElements( array( $file, $message, $submit ) );

// Get rid of all element decorators except for ViewHelper to render
// the individual elements and Errors decorator to render the errors.
$form-&gt;setElementDecorators( array( 'ViewHelper', 'Errors' ) );

 

// The file element requires the File decorator instead of the 
// ViewHelper decorator
$file-&gt;setDecorators( array( 'File', 'Errors' ) ); 
 
// Create an instance of Zend_View and set the directory 
// for the template files
$view = new Zend_View();
$view-&gt;setScriptPath( __DIR__ );

// Tell all the elements in the form which view to use when rendering
foreach ($form as $item){
    $item-&gt;setView($view);
}



// process or display the form
if( isset( $_POST['submit'] ) &amp;&amp; ( $form-&gt;isValid( $_POST ) ) ) {


    $uploadHandler = new Zend_File_Transfer_Adapter_Http();
    $uploadHandler-&gt;setDestination( __DIR__ .'/uploads/' );
    try {
        $uploadHandler-&gt;receive();
        
        $data = $form-&gt;getValues();
        Zend_Debug::dump($data, 'Form Data:');
        
        $fullPath = $uploadHandler-&gt;getFileName( 'file' );

        $size = $uploadHandler-&gt;getFileSize( 'file' );
        
        $mimeType = $uploadHandler-&gt;getMimeType( 'file' );
        
        $fileInfo = pathinfo( $fullPath );
        
        
        $name =  $fileInfo['basename'] . '&lt;br&gt;';
        
        $newName = 'RM-' . time() . '-' . $fileInfo['basename'] . ;

        $fullFilePath = __DIR__ .'/uploads/'.$newName;

        // Rename for security purposes
        $filterFileRename = new Zend_Filter_File_Rename(
            array('target' =&gt; $fullFilePath, 'overwrite' =&gt; true)
        );

        $filterFileRename -&gt; filter($fullPath);

        
        echo 'thanks &lt;br /&gt;';
    } catch ( Zend_File_Transfer_Exception $e ) {
        echo $e-&gt;getMessage();
    }
    
    
} else {
    echo $form-&gt;render( $view );
}
</pre><pre class="brush:php;">
&lt;?php
/**
 * @file form-contact.tpl.php
 */
?&gt;
&lt;!doctype html&gt;  
&lt;html lang="en"&gt;  
&lt;head&gt;  
&lt;meta charset="utf-8"&gt;  
&lt;title&gt;Stand Alone Zend Form&lt;/title&gt;  
&lt;meta name="description" content="Stand Alone Zend Form"&gt;  
&lt;meta name="author" content="Rayhan Muktader"&gt;  
&lt;!--[if lt IE 9]&gt;  
&lt;script src="<a href="http://html5shiv.googlecode.com/svn/trunk/html5.js&quot;&gt;&lt;/script&gt;">http://html5shiv.googlecode.com/svn/trunk/html5.js"&gt;&lt;/script&gt;</a>  
&lt;![endif]--&gt;  
&lt;/head&gt;  
&lt;body&gt;  
      
    &lt;form id="contact" action="&lt;?= $this-&gt;element-&gt;getAction(); ?&gt;" 
        method="&lt;?= $this-&gt;element-&gt;getMethod(); ?&gt;"
        enctype="&lt;?= $this-&gt;element-&gt;getEnctype();?&gt;"&gt;

        &lt;table&gt;
            &lt;tr&gt;
                &lt;td&gt;Upload File:&lt;/td&gt;
                &lt;td&gt;&lt;?= $this-&gt;element-&gt;file; ?&gt;&lt;/td&gt;
            &lt;/tr&gt;

            &lt;tr&gt;
                &lt;td&gt;Message:&lt;/td&gt;
                &lt;td&gt;&lt;?= $this-&gt;element-&gt;message; ?&gt;&lt;/td&gt;
            &lt;/tr&gt;
            
            &lt;tr&gt;
                &lt;td&gt;&lt;?= $this-&gt;element-&gt;submit ?&gt;&lt;/td&gt;
            &lt;/tr&gt;
        &lt;/table&gt;
    &lt;/form&gt;
    
&lt;/body&gt;  
&lt;/html&gt;  
</pre></div></div></div><section class="field field-name-field-tags field-type-taxonomy-term-reference field-label-above view-mode-full"><h2 class="field-label">Tags:&nbsp;</h2><ul class="field-items"><li class="field-item even" id="md2"><a href="/tags/zend-framework-1x" typeof="skos:Concept" property="rdfs:label skos:prefLabel" datatype="">zend-framework-1.X</a></li><li class="field-item odd" id="md4"><a href="/tags/zend-form" typeof="skos:Concept" property="rdfs:label skos:prefLabel" datatype="">zend-form</a></li><li class="field-item even" id="md6"><a href="/tags/zend-form-element-file" typeof="skos:Concept" property="rdfs:label skos:prefLabel" datatype="">zend-form-element-file</a></li><li class="field-item odd" id="md8"><a href="/tags/file-upload" typeof="skos:Concept" property="rdfs:label skos:prefLabel" datatype="">file-upload</a></li></ul></section>    </div>

    
    
  </div>
</article>

  </div><meta  itemscope="" itemid="/zend-framework-stand-alone-upload-form" itemref="md1 md3 md5 md7 md9" /><meta  itemscope="" itemid="/tags/zend-framework-1x" id="md3" itemref="md2" /><meta  itemscope="" itemid="/tags/zend-form" id="md5" itemref="md4" /><meta  itemscope="" itemid="/tags/zend-form-element-file" id="md7" itemref="md6" /><meta  itemscope="" itemid="/tags/file-upload" id="md9" itemref="md8" /></div>                      </div>

                      
                    </div>
                  </div>

                </section>

                
              </div>
            </div>

                        
          </div>
        </div>

      </div>
    </div>

    
    
          <div id="footer-wrapper">
        <div class="container clearfix">
          <footer class="clearfix" role="contentinfo">
            <div class="region region-footer"><div class="region-inner clearfix"><div id="block-system-powered-by" class="block block-system no-title odd first last block-count-3 block-region-footer block-powered-by"  role="complementary"><div class="block-inner clearfix">  
  
  <div class="block-content content"><span>Powered by <a href="https://www.drupal.org">Drupal</a></span></div>
  </div></div></div></div>            <p class="attribute-creator"></p>
          </footer>
        </div>
      </div>
    
  </div>
</div>
  <script src="/sites/default/files/js/js_Rk5YIkK6m2gKTGH-GrMu0pM_PlMKXnI0ktQUgXw1XgA.js"></script>
</body>
</html>
