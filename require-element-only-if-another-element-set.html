<!DOCTYPE html>
<!--[if lt IE 7]><html class="lt-ie9 lt-ie8 lt-ie7" lang="en" dir="ltr"><![endif]-->
<!--[if IE 7]><html class="lt-ie9 lt-ie8" lang="en" dir="ltr"><![endif]-->
<!--[if IE 8]><html class="lt-ie9" lang="en" dir="ltr"><![endif]-->
<!--[if gt IE 8]><!--><html lang="en" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ og: http://ogp.me/ns# rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema#"><!--<![endif]-->
<head>
<meta charset="utf-8" />
<link rel="shortlink" href="/node/11" />
<link rel="shortcut icon" href="/sites/all/themes/humblebeggining/favicon.ico" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
<link rel="canonical" href="/require-element-only-if-another-element-set" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<title>Require Element Only If Another Element Is Set  | strayed-bits.net</title>
<link rel="stylesheet" href="/sites/default/files/css/css_xE-rWrJf-fncB6ztZfd2huxqgxu4WO-qwma6Xer30m4.css" media="all" />
<link rel="stylesheet" href="/sites/default/files/css/css_uGbAYUquy_hLL8-4YI1pUCShW2j1u-tewieW2F4S-ks.css" media="all" />
<link rel="stylesheet" href="/sites/default/files/css/css_y7x-E9HU1xpIegvHoNXPU22DGIObba-YNi7929-l8do.css" media="all" />
<link rel="stylesheet" href="/sites/default/files/css/css_WkIQlS2V8h4Vh16HARhGTGX8u2nA_FzvuTZ5-DXLwaQ.css" media="screen" />
<link rel="stylesheet" href="/sites/default/files/css/css_8Na81x0TlPmv0mkfYwNa_rXnluHjk6jVfeDy47i0A6g.css" media="all" />
<link rel="stylesheet" href="/sites/default/files/css/css_5TxylIDFcnpmO5ucPRfXTdJiyW00MUBYhBuo7SANpds.css" media="print" />
<link rel="stylesheet" href="/sites/default/files/css/css_szF50th7JCQ5i-POEGKXQP_VswalbWOHBoB9pdfA5j0.css" media="only screen" />
<link rel="stylesheet" href="/sites/default/files/css/css_RqJOM7P-Bm3_FSClEoZknlX2hqHqo9WVAtkBV6DUX4U.css" media="screen" />
<link rel="stylesheet" href="/sites/default/files/css/css_gccWjowuH2fga-UCn3xqMw9Uiy1zP2lhOgGv8CdwGnY.css" media="only screen" />

<!--[if lt IE 9]>
<link rel="stylesheet" href="/sites/default/files/css/css_-ZfMH-iGLlNE6FZNiIjxRGAkOtmJJKiJ_uqtiYeduqw.css" media="screen" />
<![endif]-->
<script src="/sites/default/files/js/js_xAPl0qIk9eowy_iS9tNkCWXLUVoat94SQT48UBCFkyQ.js"></script>
<script src="/sites/default/files/js/js_fgYrkXtuxzG9Elq7qwZaJnWe7qsPHbpE3Jg3qw1CVcc.js"></script>
<script>jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"humblebeginning","theme_token":"sNNCJPx2b5apuzsZqaztkRjGU3nQ--CHM3tWOZyeepk","js":{"sites\/all\/modules\/syntaxhighlighter\/syntaxhighlighter.min.js":1,"misc\/jquery.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shCore.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushCss.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushJScript.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushPhp.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushSql.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushXml.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/comment\/comment.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/ctools\/css\/ctools.css":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/styles\/shCore.css":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/styles\/shThemeDefault.css":1,"sites\/all\/themes\/adaptivetheme\/at_core\/css\/at.settings.style.headings.css":1,"sites\/all\/themes\/adaptivetheme\/at_core\/css\/at.settings.style.image.css":1,"sites\/all\/themes\/adaptivetheme\/at_core\/css\/at.layout.css":1,"sites\/all\/themes\/corolla\/css\/html-elements.css":1,"sites\/all\/themes\/corolla\/css\/forms.css":1,"sites\/all\/themes\/corolla\/css\/tables.css":1,"sites\/all\/themes\/corolla\/css\/page.css":1,"sites\/all\/themes\/corolla\/css\/articles.css":1,"sites\/all\/themes\/corolla\/css\/comments.css":1,"sites\/all\/themes\/corolla\/css\/fields.css":1,"sites\/all\/themes\/corolla\/css\/blocks.css":1,"sites\/all\/themes\/corolla\/css\/navigation.css":1,"sites\/all\/themes\/corolla\/css\/fonts.css":1,"sites\/all\/themes\/corolla\/css\/corolla.settings.style.css":1,"sites\/all\/themes\/corolla\/color\/colors.css":1,"sites\/all\/themes\/humblebeggining\/css\/humblebeginning.css":1,"sites\/all\/themes\/corolla\/css\/print.css":1,"public:\/\/adaptivetheme\/humblebeginning_files\/humblebeginning.responsive.layout.css":1,"public:\/\/adaptivetheme\/humblebeginning_files\/humblebeginning.fonts.css":1,"public:\/\/adaptivetheme\/humblebeginning_files\/humblebeginning.responsive.styles.css":1,"public:\/\/adaptivetheme\/humblebeginning_files\/humblebeginning.lt-ie9.layout.css":1}},"adaptivetheme":{"humblebeginning":{"layout_settings":{"bigscreen":"three-col-grail","tablet_landscape":"three-col-grail","tablet_portrait":"one-col-vert"},"media_query_settings":{"bigscreen":"only screen and (min-width:1025px)","tablet_landscape":"only screen and (min-width:769px) and (max-width:1024px)","tablet_portrait":"only screen and (min-width:481px) and (max-width:768px)"}}}});</script>
<!--[if lt IE 9]>
<script src="/sites/all/themes/adaptivetheme/at_core/scripts/html5.js?"></script>
<![endif]-->
</head>
<body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-11 node-type-article atv-0.1 site-name-strayed-bitsnet section-require-element-only-if-another-element-set color-scheme-default humblebeginning bs-n bb-n mb-dd rc-6 rct-6">
  <div id="skip-link" class="nocontent">
    <a href="#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
    <div id="page-wrapper">
  <div id="page" class="page snc-n snw-n sna-l sns-n ssc-n ssw-n ssa-l sss-n btc-n btw-b bta-l bts-n ntc-n ntw-b nta-l nts-n ctc-n ctw-b cta-l cts-n ptc-n ptw-b pta-l pts-n">

          <div id="menu-bar-wrapper">
        <div class="container clearfix">
          <div id="menu-bar" class="nav clearfix"><nav id="block-system-main-menu" class="block block-system block-menu menu-wrapper menu-bar-wrapper clearfix odd first last block-count-1 block-region-menu-bar block-main-menu"  role="navigation">  
      <h2 class="element-invisible block-title">Main menu</h2>
  
  <ul class="menu clearfix"><li class="first leaf menu-depth-1 menu-item-391"><a href="/about">About</a></li><li class="last leaf menu-depth-1 menu-item-218"><a href="/">Home</a></li></ul>
  </nav></div>        </div>
      </div>
    
    <div id="header-wrapper">
      <div class="container clearfix">

        <header class="clearfix with-logo" role="banner">

                      <div id="branding" class="branding-elements clearfix">

                              <div id="logo">
                  <a href="/"><img class="site-logo" typeof="foaf:Image" src="/sites/all/themes/humblebeggining/logo.png" alt="strayed-bits.net" /></a>                </div>
              
                              <div class="h-group" id="name-and-slogan">

                                      <h1 id="site-name"><a href="/" title="Home page">strayed-bits.net</a></h1>
                  
                  
                </div>
              
            </div>
          
          
        </header>

      </div>
    </div>

    
    
    
    <div id="content-wrapper">
      <div class="container">

        <div id="columns">
          <div class="columns-inner clearfix">

            <div id="content-column">
              <div class="content-inner">

                
                <section id="main-content" role="main">

                  
                  <div class="content-margin">
                    <div class="content-style">

                      
                      
                      
                                              <header class="clearfix">
                          <h1 id="page-title">
                            Require Element Only If Another Element Is Set                           </h1>
                        </header>
                      
                      
                      
                      <div id="content">
                        <div class="region region-content"><div id="block-system-main" class="block block-system no-title odd first last block-count-2 block-region-content block-main" >  
  
  <article id="node-11" class="node node-article node-promoted article odd node-full ia-n clearfix" role="article">
  <div class="node-inner">

    
              <header class="node-header">

                  <h1 class="node-title">
                          Require Element Only If Another Element Is Set                       </h1>
        
                  <p class="submitted">Submitted by <span class="username">Rayhan Muktader</span> on <time datetime="2013-07-21T23:39:35-0400" pubdate="pubdate">Sun, 07/21/2013 - 23:39</time></p>
        
      </header>
        
    <div class="node-content">
        <div class="field field-name-body field-type-text-with-summary field-label-hidden view-mode-full"><div class="field-items" id="md1"><div class="field-item even"><p>This validator class makes a form element "required" if and only if another element is set.</p>
<pre class="brush:php">
&lt;?php

/**
 * Requires an element if conditional elemet is set
 *
 * @author rmuktader
 */
class My_Validate_RequiredIfConditionalElementSet extends Zend_Validate_NotEmpty
{
     /**
     * Error codes
     * @const string
     */
    const REQUIRED          = 'required';
    
    const MISSING_COND_ELEM = 'missingCondElem';
    
    const CONTEXT_NULL      = 'contextNull';
    
    const CONTEXT_NOT_ARRAY = 'contextNotArray';
    
    const COND_ELEM_NOT_IN_CONTEXT = 'condElemNotInContext';
    

    /**
     * Error messages
     * @var array
     */
    protected $_messageTemplates = array(
        self::REQUIRED          =&gt; 'Value is required and can\'t be empty',
        self::MISSING_COND_ELEM =&gt; 'No conditional element provided',
        self::CONTEXT_NULL      =&gt; 'The context is null',
        self::CONTEXT_NOT_ARRAY =&gt; 'The context is not an array',
        self::COND_ELEM_NOT_IN_CONTEXT  =&gt; 'The conditional element was not found in the context array',
    );
    
    protected $condElem = null;
    protected $condElemVal = null;
    
    public function __construct($options)
    {
        if (isset($options['conditionalElement']) &amp;&amp;
           !empty($options['conditionalElement'])) {
            
               $this-&gt;setCondElem($options['conditionalElement']);
        } 
       
       
       if (isset($options['conditionalElementValue'])) {

            $this-&gt;setCondElemVal($options['conditionalElementValue']);
           
        } 
       
    }
    
    /**
     * Retrieve conditional element
     *
     * @return string
     */
    public function getCondElem() {
        return $this-&gt;condElem;
    }

    /**
     * @param  string $condElem
     * @return My_Validate_RequiredIfConditionalElementSet
     */
    public function setCondElem($condElem) {
        $this-&gt;condElem = (string) $condElem;
        $this-&gt;condElem = trim($this-&gt;condElem);
        return $this;
    }

    /**
     * Retrieve conditional element value
     *
     * @return string
     */
    public function getCondElemVal()
    {
        return $this-&gt;condElemVal;
    }
    
    /**
     * @param  string $condElemVal
     * @return My_Validate_RequiredIfConditionalElementSet
     */
    public function setCondElemVal($condElemVal)
    {
        $this-&gt;condElemVal = $condElemVal;
        return $this;
    }
    
    /**
     * Defined by Zend_Validate_Interface
     *
     * @param  string $value
     * @param array $context.  When used with a form this array contains the names of the form elements 
     * as keys and the corresponding form element values as the array values.
     *
     * @return boolean
     */
    public function isValid($value, $context = null)
    {
        $condElem = $this-&gt;getCondElem();
        $condElemVal = $this-&gt;getCondElemVal();
     
        if ($condElem === null) {
            $this-&gt;_error(self::MISSING_COND_ELEM);
            return false;
        }
        
        if ($context === null) {
            $this-&gt;_error(self::CONTEXT_NULL);
            return false;
        }
        
        if (!is_array($context)) {
            $this-&gt;_error(self::CONTEXT_NOT_ARRAY);
            return false;
        }
        
        if (!isset($context[$condElem])) {
            $this-&gt;_error(self::COND_ELEM_NOT_IN_CONTEXT);
            return false;
        }
        
        /**
         * if $condElemVal is not set return false if the conditional element value 
         * is not empty and $value is empty
         */
        if (!isset($condElemVal) &amp;&amp; !empty($context[$condElem]) &amp;&amp; !parent::isValid($value)) {
            $this-&gt;_error(self::REQUIRED);
            return false;
        }
        
        if (($condElemVal == $context[$condElem]) &amp;&amp; (!parent::isValid($value))){
            $this-&gt;_error(self::REQUIRED);
            return false;
        }
        
        return true;
    }
}
</pre><h4>Usage:</h4>
<p>The following code will make the credit card text field required if the value of a field called "paymentMethod" is set to 1.</p>
<pre class="brush:php">
$this-&gt;addElement('text', 'ccnum', array(
    'placeholder'         =&gt; 'Credit Card Number*',
    'filters'       =&gt; array('StringTrim', 'StripTags'),
    'allowEmpty'    =&gt; false,
    'validators'    =&gt; array(
        array(
            'RequiredIfConditionalElementSet', true, array( 
                'conditionalElement' =&gt; 'paymentMethod',
                'conditionalElementValue' =&gt; 1,
            ),
        ),
    ),
    'decorators'    =&gt; array('ViewHelper','Errors'),
));
</pre><p>You pass in 'conditionalElement' which contains the name of the conditional element which has to be set in order for your element to be required; and you pass in 'conditionalElementValue'  which contains the value the conditional element has to be set to in order for your element to be required.  When 'conditionalElementValue' is not passed into the validator, the validator will make your element required as long as the conditional element is not empty.</p>
<p>
<em>NB:</em> The following is how I told my form how to locate my validator.  <span style="font-style:italic">$this</span> represents the form object.
</p>
<pre class="brush:php">
$this-&gt;addElementPrefixPath('My_Validate', 'My/Validate/', 'validate');
</pre></div></div></div><section class="field field-name-field-tags field-type-taxonomy-term-reference field-label-above view-mode-full"><h2 class="field-label">Tags:&nbsp;</h2><ul class="field-items"><li class="field-item even" id="md2"><a href="/tags/zend-framework-1x" typeof="skos:Concept" property="rdfs:label skos:prefLabel" datatype="">zend-framework-1.X</a></li><li class="field-item odd" id="md4"><a href="/tags/zend-form" typeof="skos:Concept" property="rdfs:label skos:prefLabel" datatype="">zend-form</a></li></ul></section>    </div>

    
    
  </div>
</article>

  </div><meta  itemscope="" itemid="/require-element-only-if-another-element-set" itemref="md1 md3 md5" /><meta  itemscope="" itemid="/tags/zend-framework-1x" id="md3" itemref="md2" /><meta  itemscope="" itemid="/tags/zend-form" id="md5" itemref="md4" /></div>                      </div>

                      
                    </div>
                  </div>

                </section>

                
              </div>
            </div>

                        
          </div>
        </div>

      </div>
    </div>

    
    
          <div id="footer-wrapper">
        <div class="container clearfix">
          <footer class="clearfix" role="contentinfo">
            <div class="region region-footer"><div class="region-inner clearfix"><div id="block-system-powered-by" class="block block-system no-title odd first last block-count-3 block-region-footer block-powered-by"  role="complementary"><div class="block-inner clearfix">  
  
  <div class="block-content content"><span>Powered by <a href="https://www.drupal.org">Drupal</a></span></div>
  </div></div></div></div>            <p class="attribute-creator"></p>
          </footer>
        </div>
      </div>
    
  </div>
</div>
  <script src="/sites/default/files/js/js_Rk5YIkK6m2gKTGH-GrMu0pM_PlMKXnI0ktQUgXw1XgA.js"></script>
</body>
</html>
